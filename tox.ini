[tox]
# envlist = py{36,37,38}-dj{11,21,22,30}
envlist = py{37}-dj{22}

[pytest]
addopts = -ra -q
django_find_project = false
python_paths = ./ryzom_example

[testenv]
usedevelop = true

commands =
    pip install -e {toxinidir}
    # py.test -vv --strict -r fEsxXw {posargs}
    # py.test -vv --cov tests --strict -r fEsxXw {posargs:tests}
    py.test -vv --cov src --strict -r fEsxXw {posargs:src}

deps =
    pytest
    pytest-django
    pytest-pythonpath
    codecov
    coverage
    pytest-cov
    pytest-mock
    mock

setenv =
    DEBUG=1
    PIP_ALLOW_EXTERNAL=true
    DJANGO_SETTINGS_MODULE=ryzom_example.settings

[testenv:qa]
commands =
    flake8 --show-source --max-complexity=8 --exclude migrations \
        src/ --builtins=ModuleNotFoundError
deps =
    flake8
    mccabe

[testenv:docs]
deps =
changedir = {toxinidir}/docs/source
commands =
    pip install -r requirements.txt
    make html
whitelist_externals =
    make

[flake8]
# exclude = ryzom_example,todos
putty-auto-ignore = true
putty-ignore =
